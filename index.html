<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026æ˜¥èŠ‚ä¸­å›½å¼äº²æˆšåº”å¯¹ç™½çš®ä¹¦</title>
    <style>
        :root {
            --primary-red: #d93025;
            --dark-red: #b71c1c;
            --gold: #f9d854;
            --bg-color: #fcefe8;
            --text-dark: #333;
            --card-bg: #fff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-dark);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 {
            color: var(--primary-red);
            text-shadow: 2px 2px 0px var(--gold);
            font-size: 2rem;
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 3px solid var(--primary-red);
            padding-bottom: 10px;
        }

        .container {
            max-width: 600px;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* å¡ç‰‡é€šç”¨æ ·å¼ */
        .card {
            background: var(--card-bg);
            border: 4px solid var(--primary-red);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 8px 8px 0px rgba(217, 48, 37, 0.2);
            position: relative;
        }

        /* --- é€‰äººç•Œé¢ --- */
        .character-select-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .char-btn {
            background: white;
            border: 2px solid var(--primary-red);
            border-radius: 8px;
            padding: 10px 5px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 110px;
        }

        .char-btn:hover {
            background: var(--gold);
            transform: translateY(-3px);
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
        }

        .char-avatar { font-size: 2rem; margin-bottom: 5px; }
        .char-name { font-weight: bold; font-size: 0.9rem; color: var(--dark-red); }
        .char-tag { font-size: 0.7rem; color: #666; margin-top: 4px; line-height: 1.2; }

        /* --- å¯¹æˆ˜ç•Œé¢ --- */
        .battle-screen {
            background: #2a2a2a;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', Courier, monospace;
            min-height: 160px;
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            border: 2px solid #555;
        }

        .boss-info {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px dashed #666;
            padding-bottom: 5px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .dialogue {
            font-size: 1.1rem;
            line-height: 1.5;
            color: #fff;
            margin: 10px 0;
            min-height: 60px;
        }

        .round-indicator {
            text-align: right;
            font-size: 0.8rem;
            color: #888;
            margin-top: 5px;
        }

        .options-grid {
            display: grid;
            gap: 10px;
        }

        .btn-option {
            background: white;
            border: 2px solid var(--text-dark);
            padding: 12px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.1s;
            text-align: left;
            border-radius: 6px;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .btn-option:hover {
            background: var(--gold);
            transform: translateY(-2px);
        }

        /* ç­–ç•¥æ ‡ç­¾é¢œè‰² */
        .tag-label {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-right: 5px;
            color: white;
            vertical-align: middle;
        }
        .bg-defend { background-color: #757575; } /* ç°è‰²-é˜²å®ˆ/è‡ªé»‘ */
        .bg-dodge { background-color: #1976D2; }  /* è“è‰²-é—ªé¿/ç³Šå¼„/åºŸè¯ */
        .bg-attack { background-color: #D32F2F; } /* çº¢è‰²-è¿›æ”»/æš´å‡»/å›æ—‹é•– */

        .status-log {
            font-size: 0.9rem;
            color: #d93025;
            margin-top: 10px;
            padding: 8px;
            background: #fff5f5;
            border-radius: 4px;
            text-align: center;
            font-weight: bold;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* --- å°´å°¬æ€¥æ•‘åŒ… --- */
        .sound-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .sound-btn {
            background: var(--primary-red);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: transform 0.1s;
        }

        .sound-btn:active { transform: scale(0.95); }
        .hidden { display: none !important; }

        /* åŠ¨ç”» */
        .shake { animation: shake 0.5s; }
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
    </style>
</head>
<body>

    <div style="margin:0 auto;width:0px;height:0px;overflow:hidden;">
        <img src="icon.jpg" width="400" alt="åˆ†äº«ç¼©ç•¥å›¾">
    </div>

    <h1>ğŸ§¨ æ˜¥èŠ‚èŒ¶è¯ä¼šç”Ÿå­˜æŒ‡å— ğŸ§¨</h1>

    <div class="container">
        
        <div class="card" id="select-screen">
            <h2>ğŸ‘¾ äº²æˆšå¯¹çº¿æ¨¡æ‹Ÿå™¨</h2>
            <p style="font-size:0.9rem; color:#666;">ä¸åŒçš„äº²æˆšæœ‰ä¸åŒçš„æ”»å‡»æµæ´¾ï¼Œè¯·è°¨æ…é€‰æ‹©ã€‚</p>
            
            <div class="character-select-grid">
                <div class="char-btn" onclick="startGame('aunt')">
                    <span class="char-avatar">ğŸ‘¹</span>
                    <span class="char-name">äºŒå¤§å¨˜</span>
                    <span class="char-tag">å‚¬å©š / å‚¬ç”Ÿ</span>
                </div>
                <div class="char-btn" onclick="startGame('uncle')">
                    <span class="char-avatar">ğŸ¤‘</span>
                    <span class="char-name">ä¸‰å”</span>
                    <span class="char-tag">æŸ¥æˆ·å£ / ç‚«å¯Œ</span>
                </div>
                <div class="char-btn" onclick="startGame('grandpa')">
                    <span class="char-avatar">ğŸ—¿</span>
                    <span class="char-name">å¤§èˆ…</span>
                    <span class="char-tag">è€ƒå…¬ / è€ƒç ”</span>
                </div>
            </div>
        </div>

        <div class="card hidden" id="battle-card">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h2 style="margin:0;">âš”ï¸ å¯¹æˆ˜è¿›è¡Œä¸­</h2>
                <button onclick="backToMenu()" style="border:none; background:transparent; text-decoration:underline; cursor:pointer; color:#666;">é€€å‡º</button>
            </div>
            
            <div class="battle-screen" id="battle-screen">
                <div class="boss-info">
                    <span id="boss-name">BOSS</span>
                    <span class="hp-bar">è€å¿ƒ: <span id="boss-hp">100</span>%</span>
                </div>
                <div class="dialogue" id="question-text">Loading...</div>
                <div class="boss-info" style="margin-top:auto; border-top:1px dashed #666; border-bottom:none; padding-top:5px;">
                    <span>YOU</span>
                    <span class="hp-bar" style="color:#0f0;">å¿ƒæƒ…: <span id="my-hp">100</span>%</span>
                </div>
                <div class="round-indicator">Round: <span id="current-round">1</span>/5</div>
            </div>

            <div class="status-log" id="status-log">æˆ˜æ–—å¼€å§‹ï¼è¯·é€‰æ‹©å›å¤...</div>

            <div class="options-grid" id="options-area">
                </div>
            
            <button onclick="backToMenu()" class="hidden" style="width:100%; padding:15px; background:#333; color:white; border:none; margin-top:10px; cursor:pointer; font-size:1rem; border-radius:6px;" id="restart-btn">è¿”å›ä¸»èœå•</button>
        </div>

        <div class="card">
            <h2>ğŸš‘ å°´å°¬ç¦»åœºæ€¥æ•‘åŒ…</h2>
            <div class="sound-grid">
                <button class="sound-btn" onclick="playFakeCall()">
                    <span style="font-size:1.2rem">ğŸ“±</span> è€æ¿æ¥ç”µ
                </button>
                <button class="sound-btn" onclick="playNotification()">
                    <span style="font-size:1.2rem">ğŸ’¬</span> å¾®ä¿¡è½°ç‚¸
                </button>
                <button class="sound-btn" onclick="playKnock()">
                    <span style="font-size:1.2rem">ğŸšª</span> æ€¥ä¿ƒæ•²é—¨
                </button>
                <button class="sound-btn" onclick="playCat()">
                    <span style="font-size:1.2rem">ğŸˆ</span> å¿…é¡»å»å–‚çŒ«
                </button>
            </div>
        </div>

    </div>

<script>
    // --- æ ¸å¿ƒæ•°æ®é…ç½® ---
    const gameData = {
        // äºŒå¤§å¨˜
        aunt: {
            name: "äºŒå¤§å¨˜",
            hp: 100,
            questions: [
                {
                    q: "å“å“Ÿï¼Œè¿˜ä¸å¸¦ä¸ªå¯¹è±¡å›æ¥å•Šï¼Ÿå¥³å­©å­/ç”·å­©å­é’æ˜¥å¯ä¸ç­‰äººå•Šï¼",
                    options: [
                        { text: "ç¼˜åˆ†è¿˜æ²¡åˆ°ï¼Œå†ç­‰ç­‰å§ï¼Œæˆ‘ä¸æ€¥ã€‚", label: "é˜²å®ˆ", logic: "defend", effect: "äºŒå¤§å¨˜å‘èµ·äº†è¯´æ•™æŠ€èƒ½" },
                        { text: "äºŒå¤§å¨˜ï¼Œæˆ‘ç°åœ¨æ­£å¤„äºæƒ…æ„Ÿæ¶æ„é‡ç»„ï¼Œç—›ç‚¹æ˜¯ä¼˜è´¨èµ„æºä¸‹æ²‰ä¸è¶³ï¼Œæ‰“ç®—æ˜¥èŠ‚åå¼€å¯å¯¹è±¡å­µåŒ–è®¡åˆ’ï¼Œäº‰å–åœ¨Q4å­£åº¦å®ç°ä¸¤äººåŒè¡Œçš„ç”Ÿæ€å¸ƒå±€ã€‚", label: "å¤§å‚åºŸè¯æ–‡å­¦", logic: "dodge", effect: "äºŒå¤§å¨˜é™·å…¥äº†çŸ­æš‚çš„æ··ä¹±ï¼Œæ€€ç–‘ä½ è¢«ä¼ é”€æ´—è„‘äº†ï¼Œçœ¼ç¥ä¸­å……æ»¡äº†æ€œæ‚¯" },
                        { text: "è¿˜æ˜¯äºŒå¤§å¨˜æ‚¨æ—©æˆå®¶å¥½å•Šï¼Œç§ç§ç°åœ¨è¿™æ—¥å­ï¼Œè¿‡å¾—å¤šå¹¸ç¦ï¼", label: "å›æ—‹é•–", logic: "attack", effect: "æš´å‡»ï¼äºŒå¤§å¨˜æƒ³èµ·äº†å®¶é‡Œä¸åšå®¶åŠ¡çš„è€å…¬ï¼Œå¼€å§‹è·Ÿä½ åæ§½å©šå§»çš„ä¸å¹¸" }
                    ]
                },
                {
                    q: "ä½ å°±æ˜¯çœ¼å…‰å¤ªé«˜äº†ï¼ä½ å¬å¤§å¨˜æˆ‘ä¸€å¥åŠï¼Œäººè€å®ã€å¯¹ä½ å¥½ã€æœ‰ä¸ªç¨³å®šå·¥ä½œå°±è¡Œäº†ï¼",
                    options: [
                        { text: "æˆ‘æ˜¯æƒ³æ‰¾ä¸ªè€å®çš„ï¼Œå¯è€å®äººä¸€çœ‹æˆ‘çˆ±èŠ±é’±ã€ä¸å¹²å®¶åŠ¡ã€è„¾æ°”è¿˜å¤§ï¼Œä¹Ÿçœ‹ä¸ä¸Šæˆ‘å•Šï¼", label: "è‡ªé»‘", logic: "defend", effect: "äºŒå¤§å¨˜ä¸€æ—¶è¯­å¡ï¼Œä¸Šä¸‹æ‰“é‡äº†ä½ ä¸€ç•ªï¼Œç«Ÿç„¶è§‰å¾—ä½ è¯´å¾—å¾ˆæœ‰é“ç†" },
                        { text: "å“å“ŸäºŒå¤§å¨˜ï¼Œè¿˜æ˜¯æ‚¨å½“å¹´æœ‰çœ¼å…‰ï¼äºŒå¤§çˆ·å½“åˆæ€ä¹ˆè¿½æ‚¨çš„ï¼Ÿæˆ‘å­¦ä¹ å­¦ä¹ ï¼", label: "æ§æ€è½¬ç§»æ³•", logic: "dodge", effect: "äºŒå¤§å¨˜è€è„¸ä¸€çº¢ï¼Œå¼€å¯30åˆ†é’Ÿçˆ±æƒ…å›å¿†å½•ï¼Œä½ ä»è¢«å®¡é—®çš„å˜æˆå¬å…«å¦çš„" },
                        { text: "æˆ‘æ­£æŒ‰æ‚¨è¿™æ ‡å‡†æ‰¾å‘¢ï¼è¦ä¸æ‚¨ç»™æˆ‘ä»‹ç»ä¸€ä¸ªï¼Ÿæ‚¨ä»‹ç»çš„è‚¯å®šé è°±ï¼", label: "ä¹–å·§é¡ºæ¯›", logic: "dodge", effect: "äºŒå¤§å¨˜ç«‹é©¬è¿›å…¥â€œçƒ­å¿ƒçº¢å¨˜â€æ¨¡å¼ï¼Œä½ è¢«åŠ¨å¼€å¯æ˜¥èŠ‚ç›¸äº²èŠ‚å¥" }
                    ]
                },
                {
                    q: "ç»“å©šè¿™ä¹ˆä¹…æ€ä¹ˆè¿˜ä¸è¦å­©å­ï¼Ÿä½ çœ‹éš”å£å°ç‹æ¯”ä½ è¿˜å°ä¸¤å²ï¼Œå­©å­éƒ½ä¼šæ‰“é…±æ²¹äº†ï¼",
                    options: [
                        { text: "æ‚¨è¿™ä¹ˆå–œæ¬¢å­©å­ï¼Œè¦ä¸æ‚¨å†ç”Ÿä¸€ä¸ªï¼Ÿç°åœ¨æ”¿ç­–å¼€æ”¾äº†ï¼Œæˆ‘è®©æˆ‘å¦ˆç»™æ‚¨ä¼ºå€™æœˆå­ï¼", label: "åå‘å‚¬ç”Ÿ", logic: "attack", effect: "äºŒå¤§å¨˜æ°”çš„å½“åœºæ™•å¥ï¼Œå‘èª“å†ä¹Ÿä¸å’Œä½ å®¶å¾€æ¥" },
                        { text: "äºŒå¤§å¨˜ï¼Œæˆ‘å€’æ˜¯æƒ³ç”Ÿï¼Œæ‚¨èƒ½æŠ½ç©ºå¸®æˆ‘å¸¦å­©å­å—ï¼Ÿ", label: "é“å¾·ç»‘æ¶", logic: "dodge", effect: "æˆåŠŸé—ªé¿ï¼ŒäºŒå¤§å¨˜è‡ªåŠ¨åˆ‡æ¢æ¢é¢˜" },
                        { text: "å°ç‹é‚£å­©å­å¥½åƒé•¿å¾—ä¸å¤ªåƒä»–å•Š...", label: "è½¬ç§»è¯é¢˜", logic: "attack", effect: "ç»æ€ï¼å…¨æ‘çš„å…«å¦è½¬ç§»äº†" }
                    ]
                },
                {
                    q: "ï¼ˆç¥ç¥ç§˜ç§˜ï¼‰ä½ å’Œå¤§å¨˜è¯´å®è¯ï¼Œæ˜¯ä¸æ˜¯èº«ä½“æœ‰é—®é¢˜ï¼Ÿå¤§å¨˜è®¤è¯†ä¸ªè€ä¸­åŒ»â€¦â€¦",
                    options: [
                        { text: "ï¼ˆå‹ä½å£°éŸ³ï¼Œä¸€è„¸ä¸¥è‚ƒï¼‰å¤§å¨˜ï¼Œæ‚¨çœ¼ç¥çœŸæ¯’ï¼Œå…¶å®æˆ‘è¿™é’±åŒ…æœ‰ç‚¹è´«è¡€ï¼Œèƒ½ä¸èƒ½è®©é‚£è€ä¸­åŒ»å¸®æˆ‘å¼€ä¸ªæ–¹å­ã€‚", label: "å“­ç©·", logic: "defend", effect: "å¤§å¨˜ä¸‹æ„è¯†æ‚ç´§äº†é’±åŒ…ï¼Œè¿…é€Ÿæ’¤é€€ã€‚" },
                        { text: "äºŒå¤§å¨˜æ‚¨çœŸæ˜¯äº²å¤§å¨˜ï¼ä½†æ‚¨è¿™æ–¹å­å…ˆç´§ç€æˆ‘å“¥å«‚ç”¨ï¼Œä»–ä¿©ä¸æ˜¯ç»“å©šæ›´æ—©å—ï¼Ÿæˆ‘æ’é˜Ÿï¼Œæˆ‘ä¸æ€¥ï¼", label: "åå®¢ä¸ºä¸»", logic: "dodge", effect: "å®Œç¾ç”©é”…ï¼Œå®¶åº­æˆ˜ç«è½¬ç§»" },
                        { text: "ï¼ˆç…æœ‰ä»‹äº‹ï¼‰å˜˜ï¼å¤§å¨˜ï¼Œè¿™äº‹å„¿å¤§å¸ˆç»™æˆ‘ç®—è¿‡äº†ï¼Œè¯´æˆ‘â€œç«¥å­åŠŸâ€è¿˜æ²¡ç»ƒæˆå‘¢ï¼Œç­‰åˆ°æˆ‘35å¹´é‚£å¹´ï¼Œæ–‡æ›²æ˜Ÿçœ‹è§æˆ‘å®¶äº®å ‚ï¼Œè‡ªç„¶å°±æŠ•èƒæ¥äº†ã€‚", label: "ç”¨é­”æ³•æ‰“è´¥é­”æ³•", logic: "dodge", effect: "äºŒå¤§å¨˜æˆåŠŸè¢«ä½ å¿½æ‚ æ‡µ" }
                    ]
                },
                {
                    q: "ä½ ä¸ç»“å©šä¸ç”Ÿå¨ƒï¼Œè€äº†ç”Ÿç—…äº†è¿ä¸ªç«¯èŒ¶å€’æ°´çš„äººéƒ½æ²¡æœ‰ï¼",
                    options: [
                        { text: "æ²¡äº‹ï¼ŒæŒ‰ç…§ç°åœ¨çš„åŠ ç­å¼ºåº¦ï¼Œæˆ‘åº”è¯¥æ´»ä¸åˆ°é‚£ä¸ªæ—¶å€™ã€‚", label: "è‡ªçˆ†", logic: "defend", effect: "æ°”æ°›ç¬é—´å‡é‡ï¼Œäº²æˆšå¼€å§‹åŠä½ èº«ä½“è¦ç´§ï¼Œå¿˜äº†å‚¬å©šã€‚" },
                        { text: "å…»å„¿ä¹Ÿä¸ä¸€å®šé˜²è€å•Šï¼Œä½ çœ‹éš”å£æå©¶ï¼Œä¸‰ä¸ªå„¿å­éƒ½ä¸ç€å®¶ï¼Œè¿‡å¹´ä¸è¿˜æ˜¯ä¸€ä¸ªäººåƒå‰©é¥­ï¼Ÿ", label: "ç°å®æš´å‡»", logic: "attack", effect: "å…¨åœºæ²‰é»˜ï¼Œéƒ¨åˆ†äº²æˆšæ„Ÿåˆ°è†ç›–ä¸­äº†ä¸€ç®­" },
                        { text: "æ‰€ä»¥æˆ‘ç°åœ¨æ›´è¦åŠªåŠ›æ”’é’±ï¼Œç­‰æˆ‘è€äº†ï¼Œé›‡ä»¨æœºå™¨äººä¼ºå€™æˆ‘ï¼ä¸€ä¸ªç«¯èŒ¶ï¼Œä¸€ä¸ªæ¶è…¿ï¼Œä¸€ä¸ªé™ªèŠè®²å…«å¦ï¼", label: "ç§‘æŠ€ä»£å¿", logic: "dodge", effect: "äºŒå¤§å¨˜çœ¼ç¥é€éœ²å‡ºäº†â€œä½ æ²¡äº‹å§â€çš„æ„å‘³" }
                    ]
                }
            ]
        },

        // ä¸‰å”
        uncle: {
            name: "ä¸‰å”",
            hp: 120, 
            questions: [
                {
                    q: "å›æ¥å•¦ï¼ä»Šå¹´å¹²å¾—å’‹æ ·ï¼Ÿå¹´è–ªæœ‰è¿™ä¸ªæ•°äº†å—ï¼Ÿï¼ˆä¼¸å‡ºä¸¤æ ¹æ‰‹æŒ‡ï¼‰",
                    options: [
                        { text: "ä¸¤åƒï¼Ÿé‚£è‚¯å®šæœ‰ï¼éƒ½ä¸æ­¢å‘¢ï¼", label: "è£…å‚»å……æ¥", logic: "dodge", effect: "ä¸‰å”è§‰å¾—ä½ æ··å¾—å¤ªæƒ¨ï¼Œä¸å¥½æ„æ€å†é—®äº†" },
                        { text: "å…¬å¸ç­¾äº†ä¿å¯†åè®®ï¼Œè¯´æ¼äº†è¦å¼€é™¤çš„ã€‚", label: "ç¥ç§˜ä¸»ä¹‰", logic: "dodge", effect: "ä¸‰å”è§‰å¾—ä½ åœ¨è£…X" },
                        { text: "ä¸åˆ°åä¸‡å§...å“¦æ‚¨é—®æœˆè–ªå•Šï¼Ÿæˆ‘ä»¥ä¸ºé—®äº¤å¤šå°‘ç¨å‘¢ã€‚", label: "åå‘ç‚«è€€", logic: "attack", effect: "ç»æ€ï¼å‡¡å°”èµ›ä¹‹ç‹" }
                    ]
                },
                {
                    q: "ä½ ä»¬å…¬å¸ä»Šå¹´æ•ˆç›Šå’‹æ ·ï¼Œå¹´ç»ˆå¥–å‘äº†å¤šå°‘å•Šï¼Ÿ",
                    options: [
                        { text: "æ²¡å¤šå°‘ï¼Œåˆšå¥½å¤Ÿç»™æ‚¨ä¹°ç‚¹æ°´æœã€‚", label: "å¤ªææ¨æ‰‹", logic: "defend", effect: "å®‰å…¨è¿‡å…³ï¼Œä½†ç•¥æ˜¾å‘å¾®" },
                        { text: "ä¸‰å”ï¼Œæˆ‘ä»¬è¿™è¡Œä¸çœ‹å¹´ç»ˆå¥–ï¼Œçœ‹ç¦æŠ¥ã€‚æˆ‘ä¸ºå…¬å¸å¥‰çŒ®ï¼Œå…¬å¸ç»™æˆ‘æˆé•¿ï¼Œè°ˆé’±å°±ä¿—äº†ã€‚", label: "äº’è”ç½‘ç‰›é©¬è‡ªå˜²", logic: "dodge", effect: "äº²æˆšä»¬éƒ½è§‰å¾—ä½ å¢ƒç•Œé«˜ï¼Œå¯¹ä½ ç«–èµ·äº†å¤§æ‹‡æŒ‡" },
                        { text: "å‘äº†ä¸‰ç®±è¥¿åŒ—é£å’Œäº”æ–¤ç”»çš„å¤§é¥¼ã€‚æˆ‘éƒ½å­˜ç€å‘¢ï¼Œæ‰“ç®—è¿‡å¹´å¸¦å›æ¥ç»™å’±å…¨å®¶å°å°é²œã€‚", label: "æŠ½è±¡è‰ºæœ¯", logic: "dodge", effect: "ä¸‰å”è¢«ä½ çš„å¹½é»˜æ„Ÿå™ä½ï¼Œä¸€æ—¶åˆ†ä¸æ¸…ä½ æ˜¯çœŸç©·è¿˜æ˜¯åœ¨è®½åˆºã€‚" }
                    ]
                },
                {
                    q: "ä½ è¿™å·¥ä½œç¨³ä¸ç¨³å®šå•Šï¼Œå¬è¯´ç°åœ¨äº’è”ç½‘å…¬å¸éƒ½åœ¨è£å‘˜ï¼Ÿçœ‹ä½ è¡¨å“¥è¿›äº†å›½ä¼ï¼Œæ—±æ¶ä¿æ”¶å¤šå¥½ï¼",
                    options: [
                        { text: "ä¸‰å”ï¼Œç°åœ¨æ²¡æœ‰ç¨³å®šçš„å·¥ä½œï¼Œåªæœ‰ç¨³å®šçš„èƒ½åŠ›ã€‚æˆ‘æ¯å¤©éƒ½åœ¨æå‡è‡ªå·±ï¼Œå°±ç®—å…¬å¸æ²¡äº†ï¼Œæˆ‘å‡ºå»åˆ†åˆ†é’Ÿä¹Ÿèƒ½å†é€ ä¸€ä¸ªã€‚", label: "æ­£èƒ½é‡æ´—è„‘", logic: "dodge", effect: "ä¸‰å”è¢«è¿™æ ¼å±€éœ‡æ’¼ï¼šâ€œæœ‰å‡ºæ¯ï¼æ˜¯è¿™ä¹ˆä¸ªç†å„¿ï¼â€" },
                        { text: "æ˜¯å•Šï¼Œè¡¨å“¥é‚£æ˜¯â€œä¸ºäººæ°‘æœåŠ¡â€ï¼Œæ ¼å±€å¤§ã€‚æˆ‘è¿™ä¿—äººï¼Œå°±é€‰æ‹©â€œä¸ºäººæ°‘å¸æœåŠ¡â€å§ã€‚", label: "æš—æ“æ“ç‚«å¯Œ", logic: "attack", effect: "ä¸‰å”å¬å‡ºä½ èµšå¾—æ¯”è¡¨å“¥å¤šï¼Œè„¸è‰²æ˜æ˜¾å˜é…¸äº†ã€‚" },
                        { text: "æˆ‘ä»¬è¿™è¡Œç¡®å®ä¸ç¨³å®šï¼Œä½†èµ”å¿é‡‘é«˜å•Šï¼è¦æ˜¯è¢«è£äº†ï¼Œæ‹¿ä¸ªâ€œN+1â€çš„å¤§ç¤¼åŒ…ï¼Œé¡¶å¾—ä¸Šè¡¨å“¥åœ¨å›½ä¼å¹²ä¸€å¹´çš„å·¥èµ„,æˆ‘å°±ç›¼ç€å…¬å¸è£æˆ‘å‘¢ï¼", label: "å‡¡å°”èµ›æ‹‰æ»¡", logic: "attack", effect: "ç ´é˜²ï¼ä¸‰å”ç”šè‡³ç¾¡æ…•èµ·ä½ çš„â€œå¤§ç¤¼åŒ…â€ã€‚" }
                    ]
                },
                {
                    q: "è¿˜åœ¨ç§Ÿæˆ¿å•Šï¼Ÿå¤§åŸå¸‚ç•™ä¸ä¸‹çš„ï¼Œæ—©ç‚¹å›è€å®¶ä¹°å¥—æˆ¿æ‰æ˜¯æ­£ç»äº‹",
                    options: [
                        { text: "æˆ‘ä¹Ÿæƒ³å›ï¼Œä½†è€æ¿ä¸æ”¾äººå•Šï¼Œéè¯´ç¦»ä¸å¼€æˆ‘ï¼Œè¿˜è¦ç»™æˆ‘åŠ è–ªï¼Œæˆ‘ä¹Ÿå¾ˆä¸ºéš¾ã€‚", label: "å‡¡å°”èµ›å¤§å¸ˆ", logic: "dodge", effect: "ä¸‰å”æ€€ç–‘ä½ åœ¨å¹ç‰›ï¼Œä½†æ‰¾ä¸åˆ°è¯æ®ã€‚" },
                        { text: "è€å®¶æˆ¿ä»·éƒ½è·Œä¸¤å¹´äº†ï¼Œç°åœ¨ä¹°ç­‰äº49å¹´å…¥å›½å†›ã€‚", label: "ç»æµå­¦é¬¼æ‰", logic: "attack", effect: "ä¸‰å”å°¬ç¬‘â€œç°åœ¨çš„å¹´è½»äººç²¾å¾—å¾ˆâ€" },
                        { text: "ä¸‰å”è¯´å¾—å¯¹ï¼æˆ‘å‰å‡ å¤©çœ‹ä¸­äº†ä¸€å¥—å­¦åŒºæˆ¿ï¼Œè¦ä¸é¦–ä»˜æ‚¨æ”¯æ´æˆ‘ç‚¹ï¼Œåˆ°æ—¶å€™æˆ¿ä»·æ¶¨äº†æˆ‘ç»™æ‚¨å…»è€ï¼", label: "å­å¿ƒè·³æ°´", logic: "attack", effect: "ä¸‰å”ç«‹å³æ‰“å²”ï¼Œè¯•å›¾å‡è£…æ²¡å¬è§è½¬ç§»è¯é¢˜" }
                    ]
                },
                {
                    q: "å¬è¯´ä½ åœ¨é‚£å¤§å…¬å¸ç®¡äº‹çš„ï¼Ÿèƒ½ä¸èƒ½ç»™ä½ è¡¨å¼Ÿå®‰æ’ä¸ªå·¥ä½œï¼Ÿ",
                    options: [
                        { text: "æˆ‘ä»¬å…¬å¸æ‹›äººå¾—ç¬”è¯•é¢è¯•ï¼Œæˆ‘è¦æ˜¯æ•¢èµ°åé—¨é©¬ä¸Šè¢«å¼€é™¤ï¼Œåˆ°æ—¶å€™è¿˜å¾—é æ‚¨ç»™æˆ‘å®‰æ’å·¥ä½œå‘¢ï½", label: "åå‘æ±‚åŠ©", logic: "defend", effect: "æ‹‰ä½å§¿æ€è®©ä¸‰å”æ¥ä¸ä¸Šè¯ï¼Œä¸å¥½æ„æ€å†ä¸ºéš¾ä½ ã€‚" },
                        { text: "å®³ï¼Œä¸‰å”æ‚¨å¤ªé«˜çœ‹æˆ‘äº†ï¼æˆ‘è¦æ˜¯èƒ½å®‰æ’å·¥ä½œï¼Œå…ˆæŠŠæˆ‘è‡ªå·±å®‰æ’æˆè€æ¿äº†ã€‚å†è¯´äº†ï¼Œè¡¨å¼Ÿè¿™ä¹ˆä¼˜ç§€ï¼Œè¿˜ç”¨æˆ‘å®‰æ’ï¼Ÿéšä¾¿æ‰¾ä¸ªå·¥ä½œéƒ½æ¯”æˆ‘å¼ºå•Šï¼", label: "è£…å‚»æ§æ€", logic: "dodge", effect: "æ—¢è‡ªè°¦å§”å©‰æ‹’ç»ï¼Œåˆæ§äº†è¡¨å¼Ÿä¸€å¥ï¼Œä¸‰å”æ²¡æ³•å†å¼ºæ±‚" },
                        { text: "å¯ä»¥å•Šæ²¡é—®é¢˜ï¼åªè¦è¡¨å¼Ÿé›…æ€è¿‡äº†8.5ï¼Œç²¾é€šPythonï¼Œæˆ‘é©¬ä¸Šå†…æ¨ï¼ä¹Ÿå°±æ˜¯å…«è½®é¢è¯•ï¼Œå‡ åƒä¸ªäººäº‰ä¸€ä¸ªå‘ï¼Œä¸ç®—ç‰¹åˆ«éš¾", label: "å€Ÿå¡ä¸‹é©´", logic: "attack", effect: "ä¸‰å”çœ‹äº†çœ‹æ—è¾¹å¤§ä¸“æ¯•ä¸šã€æ­£åœ¨æ–—åœ°ä¸»çš„è¡¨å¼Ÿï¼Œå°´å°¬åœ°ç¬‘äº†ç¬‘ï¼šâ€œé‚£å•¥ï¼Œåƒèœï¼Œåƒèœã€‚â€" }
                    ]
                }
            ]
        },

        // å¤§èˆ…
        grandpa: {
            name: "å¤§èˆ…",
            hp: 130, 
            questions: [
                {
                    q: "å¤§å­¦ä¸»è¦ä»»åŠ¡è¿˜æ˜¯å­¦ä¹ ï¼ä½ æœŸæœ«è€ƒäº†å¤šå°‘åˆ†ï¼Ÿå¹³å‡ç»©ç‚¹æœ‰3.9å—ï¼Ÿ",
                    options: [
                        { text: "è¿˜è¡Œï¼Œæˆ‘ä¸»æ‰“ä¸€ä¸ªå‚ä¸æ„Ÿï¼Œæˆç»©å•éƒ½äº¤ç»™å‘½è¿å®‰æ’ã€‚", label: "ç³Šå¼„å­¦å¤§å¸ˆ", logic: "dodge", effect: "å¤§èˆ…ç¬‘ç€æ‘‡å¤´ï¼Œæ”¾å¼ƒè¿½é—®ï¼Œè½¬å¤´è·Ÿä½ å¦ˆè¯´ï¼šâ€œå­©å­å¼€å¿ƒå°±å¥½ã€‚â€" },
                        { text: "ç¡®å®è€ƒäº†3.9ï¼Œç™¾åˆ†åˆ¶çš„ã€‚", label: "å•ä½é­”æœ¯", logic: "defend", effect: "å¤§èˆ…åˆšè¦å¤¸ä½ ï¼Œçªç„¶æ„è¯†åˆ°å“ªé‡Œä¸å¯¹" },
                        { text: "è¿˜æ²¡å‡ºåˆ†å‘¢ã€‚å¯¹äº†èˆ…ï¼Œå¬å§¥å§¥è¯´æ‚¨å½“å¹´ä¸Šé«˜ä¸­çš„æ—¶å€™ï¼Œæ•°å­¦å¥½åƒè¡¥è€ƒäº†ä¸‰æ¬¡æ‰è¿‡ï¼Ÿè¿™æ˜¯çœŸçš„å‡çš„å•Šï¼Ÿæˆ‘ä¸€ç›´å½“åŠ±å¿—æ•…äº‹å¬å‘¢ï¼", label: "è€ƒå¤æŒ–æ˜", logic: "attack", effect: "å¤§èˆ…çªç„¶å‰§çƒˆå’³å—½ï¼Œä»¥æ­¤æ©é¥°å°´å°¬ï¼Œå¹¶è¿…é€Ÿè½¬ç§»è¯é¢˜å»æ‰¹è¯„æ—è¾¹çš„è¡¨å¼Ÿç©æ‰‹æœºã€‚" }
                    ]
                },
                {
                    q: "ï¼ˆæ‰“é‡ä¸€ç•ªï¼‰ å…‰ä¼šè¯»ä¹¦ä¹Ÿä¸è¡Œå•Šï¼ä½ åœ¨å­¦æ ¡å½“å­¦ç”Ÿå¹²éƒ¨äº†å—ï¼Ÿå…¥å…šäº†å—ï¼Ÿ",
                    options: [
                        { text: "å…¥äº†å…¥äº†ï¼Œä¹Ÿä¸çŸ¥é“æ€ä¹ˆå°±æ··äº†ä¸ªå­¦ç”Ÿä¼šä¼šé•¿ã€‚ å¹³æ—¶äº‹å„¿ç‰¹å¤šï¼Œæˆ‘éƒ½æ€•è€½è¯¯å­¦ä¹ ï¼Œæ­£æƒ³ç€è¦ä¸è¦è¾äº†ä¸“å¿ƒæç§‘ç ”å‘¢ï¼", label: "æ·¡å®šè£…X", logic: "dodge", effect: "äº²æˆšä»¬å¬äº†éƒ½å¤¸ä½ æœ‰å‡ºæ¯" },
                        { text: "å½“äº†å¯å®¤é•¿ï¼Œä¸å¤§ä¸å°çš„èŠéº»å®˜å§ï¼Œç®¡ç€äº”ä¸ªäººçš„ç”Ÿè€ç—…æ­»å‘¢ï¼", label: "åŸºå±‚æ²»ç†", logic: "dodge", effect: "å¤§èˆ…è§‰å¾—ä½ çš„å¹ç‰›æœ¬äº‹å·²ç»å…·å¤‡äº†é¢†å¯¼å¹²éƒ¨çš„ç´ è´¨ã€‚" },
                        { text: "å…¥äº†ï¼Œçµæ´»å…¥ï¼ç›®å‰å¤„äºâ€œæ€æƒ³ç§¯æã€è¡ŒåŠ¨è§‚æœ›ã€å®¤å‹åå¯¹â€çš„ä¸‰æœŸä¸´åºŠé˜¶æ®µã€‚", label: "æ•æ·å…¥å…š", logic: "dodge", effect: "å¤§èˆ…æ‘‡äº†æ‘‡å¤´ï¼Œè§‰å¾—ä½ è¿™å­©å­çœŸè´«" }
                    ]
                },
                {
                    q: "èƒ½ç›´åšå—ï¼Ÿä¸€å®šè¦è¯»åšå•Šï¼Œç°åœ¨ç¡•å£«æ»¡è¡—èµ°ï¼Œåšå£«æ‰å€¼é’±ã€‚",
                    options: [
                        { text: "åšå£«é‚£æ˜¯ç§‘å­¦å®¶è¯»çš„ï¼Œæˆ‘ç®—è¿‡å‘½äº†ï¼Œå¤§å¸ˆè¯´æˆ‘é€‚åˆæ—©ç‚¹å‡ºæ¥å½“è€æ¿ï¼Œç®¡åšå£«ã€‚", label: "ç„å­¦", logic: "dodge", effect: "è™½ç„¶å¾ˆæ‰¯ï¼Œä½†å¯¹è¿·ä¿¡çš„å¤§èˆ…æ¥è¯´æ•ˆæœæ‹”ç¾¤ã€‚" },
                        { text: "è¯»ï¼è‚¯å®šè¯»ï¼ä¸è¿‡ç›´åšä¸€è¯»å°±æ˜¯5å¹´èµ·æ­¥ï¼Œæ¯•ä¸šæˆ‘éƒ½å¿«30äº†ï¼Œåˆ°æ—¶å€™æ‚¨å¯åˆ«å‚¬æˆ‘æ‹çˆ±ç»“å©šç”Ÿå­©å­å•Šã€‚å­¦å†å’Œå¤–ç”¥å­™ï¼Œæ‚¨å’Œæˆ‘å¦ˆç°åœ¨å•†é‡ä¸€ä¸‹ï¼Œåªèƒ½é€‰ä¸€ä¸ªï¼", label: "å›šå¾’å›°å¢ƒ", logic: "attack", effect: "äº²æˆšé™·å…¥äº†å·¨å¤§çš„ä¸¤éš¾å¢ƒåœ°" },
                        { text: "å€¼é’±æ˜¯å€¼é’±ï¼Œå°±æ˜¯å˜ç°å‘¨æœŸå¤ªé•¿ã€‚æˆ‘çœ‹æ–°é—»äº†ï¼Œç°åœ¨åšå£«æ¯•ä¸šé€å¤–å–çš„ä¸å°‘ï¼Œæˆ‘è¿˜ä¸å¦‚ç°åœ¨å°±å»é€ï¼Œå°‘èµ°5å¹´å¼¯è·¯ã€‚", label: "é€»è¾‘é¬¼æ‰", logic: "attack", effect: "äº²æˆšCPUè¿‡è½½ï¼Œå‘ç°ä½ çš„é€»è¾‘åœ¨â€œæé’±â€è¿™ä¸ªå±‚é¢ç«Ÿç„¶æ— æ‡ˆå¯å‡»ã€‚" }
                    ]
                },
                {
                    q: "è®ºæ–‡å‘è¡¨äº†å‡ ç¯‡å•Šï¼Ÿä»Šå¹´èƒ½é¡ºåˆ©æ¯•ä¸šå—ï¼Ÿ",
                    options: [
                        { text: "å‘äº†ï¼Œæœ‹å‹åœˆå‘äº†ä¸‰ç¯‡ï¼Œç‚¹èµæ•°æ¯”å½±å“å› å­é«˜å¤šäº†ã€‚", label: "æ–°åª’ä½“å­¦æœ¯", logic: "dodge", effect: "å¤§èˆ…è®©ä½ æŠŠé“¾æ¥å‘å®¶æ—ç¾¤ï¼Œä»–è¦è½¬å‘" },
                        { text: "ï¼ˆæ‘˜ä¸‹å¸½å­ï¼‰å¤§èˆ…ï¼Œæ‚¨çœ‹æˆ‘è¿™å¤´å‘ï¼Œæˆ‘å¯¼å¸ˆè¯´äº†ï¼Œä»€ä¹ˆæ—¶å€™æˆ‘ä¸æ´—å¤´ä¹Ÿæ²¡äººèƒ½çœ‹å‡ºæ¥çš„æ—¶å€™ï¼Œè®ºæ–‡å°±å‘å‡ºæ¥äº†ã€‚", label: "ç”Ÿç†ç¤ºå¨", logic: "defend", effect: "å¤§èˆ…çœ‹ç€ä½ é‚£ä»¤äººå¿ƒç–¼çš„å‘é‡ï¼ŒæŠŠå˜´è¾¹çš„è¿½é—®å’½äº†å›å»ï¼Œè½¬è€Œç»™ä½ å¤¹äº†ä¸€å—çŒªè¹„è¡¥è¡¥" },
                        { text: "èƒ½ä¸èƒ½æ¯•ä¸šï¼Œå¾—çœ‹ç¾å›½é‚£ä¸ªOpenAIå…¬å¸äº†ã€‚è¿™å‡ å¤©ChatGPTæœåŠ¡å™¨è€å´©ï¼Œæˆ‘è¿™è®ºæ–‡æ†‹ä¸å‡ºæ¥äº†â€¦â€¦", label: "èµ›åšç®—å‘½", logic: "dodge", effect: "å¤§èˆ…ä¼¼æ‡‚éæ‡‚ï¼Œä¸€è„¸ä¸¥è‚ƒï¼šâ€œåˆæ˜¯ç¾å›½å…¬å¸ï¼Ÿè¿™å¸®è€å¤–å¤ªåäº†ï¼ä¸“é—¨å¡å’±ä»¬è„–å­ï¼â€" }
                    ]
                },
                {
                    q: "åˆ«æé‚£äº›æ²¡ç”¨çš„å®ä¹ ï¼Œèµ¶ç´§å‡†å¤‡è€ƒå…¬ï¼å®‡å®™å°½å¤´æ˜¯ç¼–åˆ¶ï¼Œå…¶ä»–éƒ½æ˜¯çå¿™ã€‚",
                    options: [
                        { text: "è€ƒï¼Œè‚¯å®šè€ƒï¼æˆ‘å·²ç»åœ¨å‡†å¤‡äº†ï¼Œæ¯å¤©ç»ƒä¹ Excelåšè¡¨ã€PPTç”»é¥¼ï¼Œè¿›å¯è€ƒå…¬ä¸Šå²¸ï¼Œé€€å¯åƒäº’è”ç½‘å¤§å‚é¥­ï¼Œæ¨ªç«–ä¸äºã€‚", label: "å¯¹å†²ç­–ç•¥", logic: "defend", effect: "å¤§èˆ…æ¬£æ…°åœ°ç‚¹äº†ç‚¹å¤´" },
                        { text: "æˆ‘ä¹Ÿæƒ³è€ƒå•Šï¼ä½†æˆ‘é…’ç²¾è¿‡æ•ï¼Œè¿™è¦æ˜¯è¿›äº†ä½“åˆ¶å†…ï¼Œä¸æ˜¯ç»™é¢†å¯¼æ·»å µå—ï¼Ÿ", label: "èŒåœºæ½œè§„åˆ™", logic: "dodge", effect: "å¤§èˆ…ä¸€å‰¯â€œæ‡‚ç‹â€è¡¨æƒ…ï¼Œé—æ†¾åœ°æ‹æ‹ä½ çš„è‚©è†€" },
                        { text: "å¤§èˆ…ï¼Œè¿™äº‹å„¿å¾—çœ‹ç¥–åŸã€‚å’±å®¶ç¥–åŸå†’çš„æ˜¯å‘è´¢çš„â€œé‡‘çƒŸâ€ï¼Œä¸æ˜¯å½“å®˜çš„â€œé’çƒŸâ€ã€‚æˆ‘è¦æ˜¯ç¡¬å»è€ƒå…¬ï¼Œæä¸å¥½ä¼šç ´äº†å’±å®¶çš„è´¢è¿ã€‚", label: "å®—æ—è¿·ä¿¡", logic: "attack", effect: "å¤§èˆ…æœ€å¬ä¸å¾—â€œç ´è´¢è¿â€è¿™ç§è¯ï¼Œç«‹åˆ»æ”¹å£è®©ä½ é¡ºåŠ¿è€Œä¸º" }
                    ]
                }
            ]
        }
    };

    // --- æ¸¸æˆé€»è¾‘ ---
    let currentBossKey = '';
    let currentQIndex = 0;
    let myHp = 100;
    let bossHp = 100;

    function startGame(bossKey) {
        currentBossKey = bossKey;
        const bossData = gameData[bossKey];
        
        myHp = 100;
        bossHp = bossData.hp;
        currentQIndex = 0;
        
        document.getElementById('select-screen').classList.add('hidden');
        document.getElementById('battle-card').classList.remove('hidden');
        
        document.getElementById('boss-name').innerText = "BOSS: " + bossData.name;
        document.getElementById('restart-btn').classList.add('hidden');
        document.getElementById('options-area').style.display = 'grid';
        document.getElementById('status-log').style.background = '#fff5f5';
        document.getElementById('status-log').style.color = '#d93025';
        
        updateStats();
        loadQuestion();
    }

    function backToMenu() {
        document.getElementById('battle-card').classList.add('hidden');
        document.getElementById('select-screen').classList.remove('hidden');
    }

    function loadQuestion() {
        const questions = gameData[currentBossKey].questions;
        
        if (currentQIndex >= questions.length) {
            endGame(true, "SURVIVED");
            return;
        }

        const qData = questions[currentQIndex];
        document.getElementById('question-text').innerText = `"${qData.q}"`;
        document.getElementById('current-round').innerText = currentQIndex + 1;
        
        const optionsHtml = qData.options.map((opt, index) => {
            let colorClass = "";
            if(opt.logic === 'defend') colorClass = "bg-defend";
            else if(opt.logic === 'dodge') colorClass = "bg-dodge";
            else if(opt.logic === 'attack') colorClass = "bg-attack";

            return `<button class="btn-option" onclick="handleChoice(${index})">
                <span class="tag-label ${colorClass}">${opt.label}</span> ${opt.text}
            </button>`
        }).join('');
        
        document.getElementById('options-area').innerHTML = optionsHtml;
        document.getElementById('status-log').innerText = "å¯¹æ–¹æ­£åœ¨è§‚å¯Ÿä½ çš„è¡¨æƒ…...";
    }

    function handleChoice(index) {
        const questions = gameData[currentBossKey].questions;
        const choice = questions[currentQIndex].options[index];
        const log = document.getElementById('status-log');
        const screen = document.getElementById('battle-screen');

        // æ˜¾ç¤ºæ•ˆæœæ–‡æœ¬
        log.innerText = choice.effect;
        log.style.background = '#e8f5e9'; // æµ…ç»¿åº•è‰²è¡¨ç¤ºå›åˆç»“æŸ
        log.style.color = '#2e7d32';

        // æ•°å€¼è®¡ç®—
        if (choice.logic === 'defend') {
            myHp -= 15; // å¿æ°”åå£°ï¼Œå†…è€—æ‰£è¡€
        } else if (choice.logic === 'dodge') {
            bossHp -= 15; // ç³Šå¼„æˆåŠŸï¼Œå¯¹æ–¹æ‰£è¡€
        } else if (choice.logic === 'attack') {
            myHp += 10; // çˆ½äº†å›è¡€
            bossHp -= 35; // æš´å‡»å¯¹æ–¹
            screen.classList.add('shake');
            setTimeout(() => screen.classList.remove('shake'), 500);
        }

        updateStats();

        if (myHp <= 0) {
            endGame(false, "DIED");
        } else if (bossHp <= 0) {
            endGame(true, "KO");
        } else {
            currentQIndex++;
            // å»¶é•¿é˜…è¯»æ—¶é—´
            setTimeout(() => {
                if (myHp > 0 && bossHp > 0) {
                   loadQuestion();
                   log.style.background = '#fff5f5';
                   log.style.color = '#d93025';
                }
            }, 2500); // 2.5ç§’é˜…è¯»æ—¶é—´
        }
    }

    function updateStats() {
        document.getElementById('my-hp').innerText = Math.max(0, myHp);
        document.getElementById('boss-hp').innerText = Math.max(0, bossHp);
        document.getElementById('my-hp').style.color = myHp < 50 ? '#d93025' : '#0f0';
    }

    function endGame(win, type) {
        let title, msg;
        const bossName = gameData[currentBossKey].name;

        if (!win) {
            title = "ğŸ’€ ç²¾ç¥å´©æºƒ...";
            msg = `ä½ æ²¡èƒ½é¡¶ä½${bossName}çš„æ”»åŠ¿ï¼Œæœ€ç»ˆç ´é˜²äº†... æ˜å¹´ä¸€å®šä¸å›æ¥äº†ï¼`;
        } else {
            if (type === "KO") {
                title = "ğŸ‰ å®Œèƒœï¼(K.O.)";
                msg = `ä½ ä¹Ÿå¤ªå‹‡äº†ï¼${bossName}è¢«ä½ æ€¼å¾—æ€€ç–‘äººç”Ÿï¼Œç”šè‡³å¼€å§‹åæ€è‡ªå·±ã€‚è¿™ä¸ªå¹´ï¼Œä½ å°±æ˜¯å®¶æ—é‡Œçš„ä¼ è¯´ï¼`;
            } else {
                title = "ğŸ˜® å‹‰å¼ºå¹¸å­˜";
                msg = `5å›åˆç»“æŸï¼Œè™½ç„¶å—äº†ç‚¹å†…ä¼¤ï¼Œä½†å¥½æ­¹æ˜¯æŠŠ${bossName}ç³Šå¼„è¿‡å»äº†ã€‚èµ¶ç´§å›æˆ¿é—´èººç€å§ã€‚`;
            }
        }
        
        document.getElementById('question-text').innerHTML = `<strong style="font-size:1.3rem; color:${win?'#f9d854':'#ff4444'}">${title}</strong><br><br>${msg}`;
        document.getElementById('options-area').style.display = 'none';
        document.getElementById('restart-btn').classList.remove('hidden');
    }

    // --- éŸ³æ•ˆåŠŸèƒ½ (å·²æ›´æ–°ä¸ºçœŸå®MP3æ–‡ä»¶) ---
    // é¢„åŠ è½½éŸ³æ•ˆæ–‡ä»¶
    const sounds = {
        call: new Audio('./sounds/call.mp3'),
        wechat: new Audio('./sounds/wechat.mp3'),
        knock: new Audio('./sounds/knock.mp3'),
        cat: new Audio('./sounds/cat.mp3')
    };

    function playFakeCall() {
        document.getElementById('status-log').innerText = "ğŸ”Š æ’­æ”¾ä¸­ï¼šè€æ¿æ¥ç”µ...";
        sounds.call.currentTime = 0; // æ¯æ¬¡ç‚¹å‡»éƒ½ä»å¤´å¼€å§‹æ’­æ”¾
        sounds.call.play().catch(e => console.log("æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„:", e));
    }

    function playNotification() {
        document.getElementById('status-log').innerText = "ğŸ”Š æ’­æ”¾ä¸­ï¼šå¾®ä¿¡è½°ç‚¸...";
        sounds.wechat.currentTime = 0;
        sounds.wechat.play().catch(e => console.log("æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„:", e));
    }

    function playKnock() {
        document.getElementById('status-log').innerText = "ğŸ”Š æ’­æ”¾ä¸­ï¼šæ•²é—¨å£°...";
        sounds.knock.currentTime = 0;
        sounds.knock.play().catch(e => console.log("æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„:", e));
    }
    
    function playCat() {
         document.getElementById('status-log').innerText = "ğŸ”Š æ’­æ”¾ä¸­ï¼šçŒ«å«...";
         sounds.cat.currentTime = 0;
         sounds.cat.play().catch(e => console.log("æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„:", e));
    }

</script>
</body>
</html>


